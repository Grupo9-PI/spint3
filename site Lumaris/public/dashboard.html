<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.1.0/dist/chartjs-chart-matrix.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-gauge@4.0.0/dist/chartjs-chart-gauge.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.1.0"></script>
  <link rel="stylesheet" href="./css/dashboard.css" />
  <link rel="stylesheet" href="./css/geral.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="shortcut icon" href="./images/Lumaris.jpg" type="image/x-icon" />
  <link href="https://fonts.cdnfonts.com/css/ds-digital" rel="stylesheet" />
</head>

<body>
  <nav class="sidebar">
    <a href="./dashboard.html" style="background-color: rgb(154, 187, 187);">
            <span class="material-icons">dashboard</span>
            Dashboard
        </a>
    <a href="./funcionarios.html">
      <span class="material-icons">people</span>
      Funcionários
    </a>
    <a href="./configuracoes.html">
      <span class="material-icons">settings</span>
      Configurações
    </a>
    <a href="./sensores.html">
      <span class="material-icons">sensors</span>
      Sensores
    </a>
    <a href="./login.html">
      <span class="material-icons">logout</span>
      Sair
    </a>
     
  </nav>

  <div class="container">
    <div class="dash">
      <div class="nav">
        <div class="titulo">
          Bem-vindo, <span id="nomeUsuario" style="color: teal;">Maré Branca</span>
        </div>

      </div>
      <div class="socorro">
        <div class="alertas">
          <div class="alerta risco" onclick="openModal('sensores')">
            <div class="titulo">Sensores em risco</div>
            <div class="valor">3 de 13 <span class="material-icons">do_not_disturb_on</span></div>
          </div>
          <div class="alerta instabilidade" onclick="openModal('instabilidade')">
            <div class="titulo">Instabilidade luminosa</div>
            <div class="valor">Ver sensores <span class="material-icons" style="margin-left: 5px;">light_mode</span></div>
          </div>
          <div class="alerta luminosidade" onclick="openModal('ideal')">
            <div class="titulo">Luminosidade da fazenda</div>
            <div class="valor">IDEAL <span class="material-icons">highlight</span></div>
          </div>
        </div>

        <div class="graficos">
          <div class="linhas">
            <canvas id="myChart"></canvas>
            <span class="material-icons" onclick="openModal('modal-linhas')" style="font-size: large;">info</span>
          </div>

          <div class="barras">
            <canvas id="myChart2"></canvas>
            <span class="material-icons" onclick="openModal('modal-barras')" style="font-size: large;">info</span>
          </div>

          <div class="donut" id="donut" style="height: 200px; width: 300px;">
            <p>Taxa de sobrevivência das ostras</p>
            <canvas id="myDonutChart"></canvas>
            <span class="material-icons" style="font-size: large;" onclick="openModal('modal-donut')">info</span>
          </div>

          <div class="economia" style="height: 150px; width: 300px;">
            Economia estimada <span style="font-weight: bold;">por mês</span><br />
            <h2 style="font-size: 33.7px;">R$ <span>142.610,56</span></h2>
            <span class="material-icons" style="font-size: large;" onclick="openModal('modal-economia')">info</span>
          </div>

          <div class="lucro" style="height: 150px; width: 300px;">
            Lucro do mês passado (BRL) <br />
            <h2><span style="color: rgb(97, 193, 97); font-size: 40px;">R$123.212,90</span></h2>
            <span class="material-icons" style="font-size: large;" onclick="openModal('modal-lucro')">info</span>
          </div>

          <div class="temporizador" style="height: 150px; width: 300px;">
            Tempo restante das ostras em
            <span id="estado" style="color: orange; font-weight: bold;"> Alta Luminsidade</span><br />
            <h1>
              <span id="temporizador" style="font-family: 'DS-digital', sans-serif; font-size: 60px;">12:00:00</span>
            </h1>
            <span class="material-icons" style="font-size: large;" onclick="openModal('modal-temporizador')">info</span>
          </div>
        </div>
      </div>
    </div>

    <div id="myModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 id="modal-title">Informações</h2>
        <p id="modal-text">Texto informativo sobre o item.</p>
      </div>
    </div>
  </div>

  <script>
    const nome = sessionStorage.NOME_USUARIO || "Maré Branca";
    const nomeUsuarioSpan = document.getElementById("nomeUsuario");
    nomeUsuarioSpan.textContent = nome;
  </script>

  <script>
    const ctx = document.getElementById('myChart');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
        datasets: [{
          label: 'Lucro (BRL)',
          data: [720, 890, 900, 1200, 1296, 1567, 1777, 2500, 2763, 3012, 3212, 3754],
          borderWidth: 1,
          backgroundColor: 'darkgreen',
          maintainAspectRatio: false,
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    const ctx2 = document.getElementById('myChart2');

    const horas = [
      '00h', '01h', '02h', '03h', '04h', '05h',
      '06h', '07h', '08h', '09h', '10h', '11h',
      '12h', '13h', '14h', '15h', '16h', '17h',
      '18h', '19h', '20h', '21h', '22h', '23h'
    ];

    const luminosidade = [
      210, 250, 240, 389, 370, 450, 800, 860, 821, 807,
      760, 750, 824, 920, 850, 750, 720, 750, 470, 455,
      490, 350, 290, 210
    ];

    new Chart(ctx2, {
      type: 'bar',
      data: {
        labels: horas,
        datasets: [{
          label: 'Luminosidade ao longo do dia (LUX)',
          data: luminosidade,
          borderWidth: 1,
          backgroundColor: '#0ABAB5',
          borderColor: 'aliceblue',
        }]
      },
      options: {
        plugins: {
          annotation: {
            annotations: {
              minClaro: {
                type: 'line',
                yMin: 600,
                yMax: 600,
                borderColor: 'green',
                borderWidth: 2,

              },
              maxClaro: {
                type: 'line',
                yMin: 900,
                yMax: 900,
                borderColor: 'green',
                borderWidth: 2,

              },

            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            max: 1000,
          },
          x: {
            grid: {
              display: false,
            }
          }
        }
      }
    });


    const ctx4 = document.getElementById('myDonutChart');

    new Chart(ctx4, {
      type: 'doughnut',
      data: {
        labels: ['Progresso', 'Faltando'],
        datasets: [{
          data: [75, 25],
          backgroundColor: ['darkslategray', '#E0E0E0'],
          borderWidth: 0,
          cutout: '80%',
        }]
      },
      options: {
        responsive: true,
        rotation: -90,
        circumference: 180,
        plugins: {
          legend: { display: false },
          tooltip: { enabled: false }
        }
      },
      plugins: [{
        beforeDraw(chart) {
          const { width, height, ctx } = chart;
          ctx.save();
          const fontSize = height / 4;
          ctx.font = `${fontSize}px sans-serif`;
          ctx.fillStyle = '#333';
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.fillText('75%', width / 2, height / 1.4);
          ctx.restore();
        }
      }]
    });
</script>


</body>

</html>